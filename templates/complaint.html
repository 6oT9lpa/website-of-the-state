<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/index-style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/doc-style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/animation-bg.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/complaint-style.css') }}">
    <title>Исковое заявление</title>
</head>
<body>
    {% block header %}
        {% include 'header/header-doc.html' %}
    {% endblock %}

    {% set user = Users.query.filter_by(static=district.created).first() %}
    {% set guest = guestUsers.query.filter_by(static=district.created).first() %}

    <div class='container-complaint'>
        <div class='main-content-complaint'>
            <div class='header-content'>
                <div class='header-statement'>
                    <div class='img-header'><img src="{{ url_for('static', filename='img/DistrictCourt.png') }}"/></div>     
                    <div class='text-header'>
                        <h4>District Court of the State of San Andreas</h4>
                        <p>Plaintiff: <b>{{ user.nikname if user else (guest.nikname if guest else 'Не найден') }}</b></p>
                        <p>Attorney for the Plaintiff: <b></b></p>
                        <p style="width: 90%;font-size: 16px;font-weight: 700;"> v. </p>
                        <div class='content-defendant'>
                            <p>Defendant:
                                {% for item in defendant %}
                                <p><b> {{ item }}, </b></p>
                                {% endfor %}
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <div class='description-content'>
                <h3>Исковое заявление № {{ "%03d" | format(district.id) }}</h3>
                <p style='text-align: center;'>Я, гражданин Соединенных штатов Америки, пользуясь своими правами подаю исковое заявление в Окружной суд штата Сан-Андреас,
                     объясняя всю ситуацию, а также прилагая все необходимые суду доказательства.</p>
                
                <p>{{ district.discription }}</p>

                <h4>Исковые требования.</h4>
                {% for item in claims %}
                    <p>{{ loop.index }}. {{ item }}</p>
                {% endfor %}
            </div>
            <div class='footer-content'>
                <p>Дата: {{ createat }}</p>
                <p style='margin-top: -5px;'>Подпись: <b style='font-family:Updock;font-size: 30px;'>
                    {{
                        (user.nikname.split()[1][0] + '. ' + user.nikname.split()[0] if user.nikname.split()|length > 1 else user.nikname) if user 
                        else 
                        (guest.nikname.split()[1][0] + '. ' + guest.nikname.split()[0] if guest.nikname.split()|length > 1 else guest.nikname)
                    }}
                </b></p>
            </div>
        </div>
        <div class="sidebar-container">
            <div class='content-sidebar'>
                <div class='header-sidebar'>
                    <h4>Статуc: </h4>
                    <p>
                        {{
                            {
                                'Waitting': 'В ожидании',
                                'Accepted': 'В работе у Прокуратуры',
                                'Rejectioned': 'Отказано',
                                'LeftMoved': 'Оставлено без движения',
                                'CourtHearing': 'Назначено заседание'
                            }.get(district.status, 'Неизвестный статус')
                        }}
                    </p>
                </div>
                {% if not district.status in ['Rejectioned', 'LeftMoved'] %}
                <div class='block-btn'>
                    {% if status == 'Judge' %}
                        {% if district.status == 'Waitting' %}
                        <div class='submit-btn-contanier'>
                            <div class='submit-btn'>
                                <input type="submit" class='accept-judge' value="Обработка иска">   
                            </div>   
                        </div> 
                        {% endif %}
                    {% endif %}
                </div>
                {% endif %}
            </div>
        </div>
    </div>
    {% if status != 'Waitting' %}
        {% for order in orders_data %}
        <div class='container-position-order'>
            <div class='contanier-court-order'>
                <div class='header-content-order'>
                    <div class='img-header-order-1'><img src='{{ url_for("static", filename="img/emblem_court.png")}}'/></div>
                    <h4>DISCRICT COURT</h4>
                    <h5>state of San-Andreas</h5>

                    <div class='img-header-order-2'><img src='{{ url_for("static", filename="img/text_separator.png")}}'/></div>

                    <div class='title-court-order'>
                        <div class='group-order'>
                            <div class='content-Plaintiff'>
                                <p>Plaintiff: <b>{{ user.nikname if user else (guest.nikname if guest else 'Не найден') }}</b></p>
                                <p>Attorney for the Plaintiff: <b>{{ user.nikname if user else (guest.nikname if guest else 'Не найден') }}</b></p>
                            </div>
                        </div>
                        
                        <div class='title'>
                            <h4>No. DC-{{ "%03d" | format(district.id) }}-2024 (NM)</h4>
                            <h4> ОПРЕДЕЛЕНИЕ No. DC-{{ "%03d" | format(district.id) }}-{{ "%02d" | format(loop.index) }} </h4>
                        </div>

                        <div class='group-order'>
                            <div class='content-Defendant'>
                                <p>Attorney for the Defendant: <b>{{ user.nikname if user else (guest.nikname if guest else 'Не найден') }}</b></p>
                                <p>Defendant:
                                    {% for item in defendant %}
                                    <p><b> {{ item }}, </b></p>
                                    {% endfor %}
                                </p>
                            </div>
                        </div>
                    </div>

                    <div class='img-header-order-2'><img src='{{ url_for("static", filename="img/text_separator.png")}}'/></div>
                </div>
                <div class='main-content-order'>
                    <h4>ОБСТОЯТЕЛЬСТВА</h4>
                    <div class='findings'> <p>{{ order.findings }}</p> </div>

                    <div class='img-header-order-2'><img src='{{ url_for("static", filename="img/text_separator.png")}}'/></div>

                    <h4>РАССМОТРЕНИЕ</h4>
                    <div class='consideration'> <p>{{ order.consideration }}</p> </div>

                    <div class='img-header-order-2'><img src='{{ url_for("static", filename="img/text_separator.png")}}'/></div>

                    <h4>ОПРЕДЕЛЕНИЕ</h4>
                    <div class='ruling'> 
                        {% for item in order.ruling %}
                            <p>{{ loop.index }}. {{ item }}</p><br>
                        {% endfor %}
                    </div>
                </div>
                <div class='footer-content'>
                    <p style='margin-top: -5px;'>Подпись: <b style='font-family:Updock;font-size: 30px;'>
                        {{
                            (user.nikname.split()[1][0] + '. ' + user.nikname.split()[0] if user.nikname.split()|length > 1 else user.nikname) if user 
                            else 
                            (guest.nikname.split()[1][0] + '. ' + guest.nikname.split()[0] if guest.nikname.split()|length > 1 else guest.nikname)
                        }}
                    </b></p>
                </div>
            </div>
        </div>
        {% endfor %}
    {% endif %}

    <div class='modal-processing-complaint' style='display:none;'>
        <form method='POST' action='/create_court_order'>
            <input type="hidden" name="uid" id="uid">
            <div class='content-modal'>
                <div class="header-modal">
                    <span class="btn-modal-close" id="btn-modal-close">&times;</span>
                    <div class="dropdown">
                        <button class="dropdown-btn">Действия</button>
                        <div class="dropdown-menu">
                            <a name='accept' data-action="accept">Принять иск</a>
                            <a name='reject' data-action="reject">Отказать в иске</a>
                            <a name='hold' data-action="hold">Оставить без движения</a>
                        </div>
                    </div>
                </div>
                <input type="hidden" name="action" id="action">
                <div class='form-control'>
                    <label for="findings">Обстоятельства.</label>
                    <div class='form-textarea'>
                        <textarea id="findings" name="findings" rows="8" cols="90" placeholder='Опишите обстоятельства'></textarea>
                    </div>
                </div>
                <div class='form-control'>
                    <label for="consideration">Рассмотрение.</label>
                    <div class='form-textarea'>
                        <textarea id="consideration" name="consideration" rows="8" cols="90" placeholder='Опишите мотивирвнное решение при рассмотрение искового заявления'></textarea>
                    </div>
                </div>
                <div class='form-control'>
                    <label for="decision">Определил.</label>
                    <div class='group-decision'> 
                    </div>
                    <div class='group-btn-decision'>
                        <a class='btn-add-input'>Добавить пункт</a>
                    </div>
                </div>

                <div class='submit-btn-contanier'>
                    <div class='submit-btn'>
                        <input type="submit" value="Оставить ответ">   
                    </div>   
                </div> 
            </div> 
        </form>
    </div>
    
    {% block footer %}
        {% include 'footer/footer.html' %}
    {% endblock %}
    <div class="overlay" id='overlay'></div>
    <div class="lines">
        {% for i in range(40) %}
          <div class="line"></div>
        {% endfor %}
    </div>

    
    {% with messages = get_flashed_messages() %}
    {% if messages %} 
    <div id="access-message" class='access-message'>
        <span class="modal-close-error">&times;</span>
        <p><strong>Внимание!</strong> {{ messages[0] }}<p>
        {% if not current_user.is_authenticated %} 
            <br>
            <a class='alert-button' href="{{ url_for('main.auth') }}">Войти в аккаунт</a>
        {% endif %}
    </div> <script src="{{ url_for('static', filename='js/script-error.js') }}" ></script>
    {% endif %}
    {% endwith %}


    <script>
        var status = {{ status | tojson }};
        const urlParams = new URLSearchParams(window.location.search);
        const uid = urlParams.get('uid');
        document.getElementById('uid').value = uid;
    </script>
    <script src="{{ url_for('static', filename='js/script-complaint.js')}}"></script>
</body>
</html>
